<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
	<link rel="stylesheet" href="css/styles.css">
</head>
	<body>
		<div class="status">
			<img src="assets/geyser.png" alt="GeyserLogo" class="logo">
			<h3>Geyser Services</h3>
			<div id="gls" class="gls-server-status">
				Global linking is: <span class="gls-server-online"></span>
			</div>
			<div id="api" class="api-status">
				Geyser API is: <span class="api-online"></span>	
			</div>
			<hr>
			<h3>Geyser servers</h3>
			<div id="test" class="test-server-status">
				Geyser test server is: <span class="test-server-online"></span>		
			</div>
			<div id="euserver" class="eu-server-status">
				GeyserConnect EU server is: <span class="eu-server-online"></span>		
			</div>
			<div id="usserver" class="us-server-status">
				GeyserConnect US server is: <span class="us-server-online"></span>		
			</div>
		</div>
	</body>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
	<script>
		var gso = document.getElementById("gls");
		var tso = document.getElementById("test");
		var ao = document.getElementById("api");
		var us = document.getElementById("usserver");
		var eu = document.getElementById("euserver");

		const url = ["test.geysermc.org", "link.geysermc.org" ,"eu.geyserconnect.net", "us.geyserconnect.net"];
		url.forEach((host) => {
			$(document).ready(() => {
				$.getJSON("https://api.mcsrvstat.us/bedrock/2/" + host, (status) => {
					if (status.debug.query) {
						if (host.includes("test")) {
							tso.style.border = "thin solid #03fc0b";
							document.querySelector('.test-server-online').innerHTML = "Online";
						}
						if (host.includes("link")) {
							gso.style.border = "thin solid #03fc0b";
							document.querySelector('.gls-server-online').innerHTML = "Online";
						}
						if (host.includes("eu")) {
							eu.style.border = "thin solid #03fc0b";
							document.querySelector('.eu-server-online').innerHTML = "Online";
						}
						if (host.includes("us")) {
							us.style.border = "thin solid #03fc0b";
							document.querySelector('.us-server-online').innerHTML = "Online";
						}
					} else {
						if (host.includes("test")) {
							tso.style.border = "thin solid #d40202";
							document.querySelector('.test-server-online').innerHTML = "offline";
						}
						if (host.includes("link")) {
							gso.style.border = "thin solid #d40202";
							document.querySelector('.gls-server-online').innerHTML = "offline";
						}
						if (host.includes("eu")) {
							eu.style.border = "thin solid #d40202";
							document.querySelector('.eu-server-online').innerHTML = "offline";
						}
						if (host.includes("us")) {
							us.style.border = "thin solid #d40202";
							document.querySelector('.us-server-online').innerHTML = "offline";
						}
					}
				});
			});
		});
	// ping api
	fetch('https://api.geysermc.org/health')
	.then(
		function(response) {
		if (response.status !== 200) {
			console.log('Could not connect to website ' +
			response.status);
			document.querySelector('.api-online').innerHTML = 'offline';
			ao.style.border = "thin solid #d40202";
			return;
		}
		if (response.ok === true) {
			document.querySelector('.api-online').innerHTML = 'online';
			ao.style.border = "thin solid #03fc0b";
		} 
	});
	</script>

</html>